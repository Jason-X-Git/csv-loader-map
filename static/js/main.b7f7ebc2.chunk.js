(this["webpackJsonpcsv-loader-map"]=this["webpackJsonpcsv-loader-map"]||[]).push([[0],{62:function(e,t,n){},70:function(e,t){},72:function(e,t){},88:function(e,t,n){"use strict";n.r(t);var i=n(2),o=n(0),r=n.n(o),a=n(23),c=n.n(a),l=(n(62),n(37)),s=n.n(l),u=n(38),d=n(14),p=n(48),m=n(4),f=n(49),b=n(108),g=Object(o.createContext)(),h=function(e){var t=Object(o.useState)({csvValues:void 0,sortedStructures:void 0}),n=Object(m.a)(t,2),r=n[0],a=n[1];return Object(i.jsx)(g.Provider,{value:[r,a],children:e.children})},y=n(64),v=Object(b.a)((function(e){return{contentDiv:{width:"100wh",height:"90vh",margin:"10px 5px"},layerListDiv:{width:"200px",fontSize:"6px",padding:0}}})),j=function(e,t){return e.localeCompare(t,"en",{numeric:!0})},x=function(){var e=Object(o.useState)({viewDiv:{width:"100wh",height:"90vh"},tableDiv:{width:"100wh",height:"0",overflow:"auto"}}),t=Object(m.a)(e,2),n=t[0],r=t[1],a=v(),c=Object(o.useContext)(g),l=Object(m.a)(c,2),b=l[0],h=l[1],x=b.csvValues,w=function(){var e=Object(p.a)(s.a.mark((function e(t){var n,i,o,a,c,l,p,g,v,x,w,O,S,D,I,L,P,k,M,N,C,E,T,A,F,z,G,B,V,R,q,W,$,H,_,Z,J,Q,K,U,X,Y,ee,te,ne,ie,oe,re,ae,ce,le,se,ue,de;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,de=function(){oe.classList.remove("active"),re.classList.remove("active"),ie.clear()},ue=function(){ie.activeTool="area",oe.classList.remove("active"),re.classList.add("active")},se=function(){ie.activeTool="distance",oe.classList.add("active"),re.classList.remove("active")},n={url:"https://js.arcgis.com/4.18/init.js",css:"https://js.arcgis.com/4.18/esri/themes/light/main.css"},e.next=7,Object(f.loadModules)(["esri/Map","esri/views/MapView","esri/layers/FeatureLayer","esri/geometry/Point","esri/geometry/Polyline","esri/Graphic","esri/widgets/LayerList","esri/widgets/Measurement","esri/widgets/FeatureTable","esri/core/Collection","esri/widgets/Home","esri/widgets/BasemapToggle","dojo/_base/array","dojo/domReady!"],n);case 7:i=e.sent,o=Object(m.a)(i,13),a=o[0],c=o[1],l=o[2],p=o[3],g=o[4],v=o[5],x=o[6],w=o[7],O=o[8],S=o[9],D=o[10],I=o[11],L=o[12],M={},t&&t.length>0?(C=t.filter((function(e){return!!e.order&&e.latitude&&e.longitude})).sort((function(e,t){return e.profile===t.profile?j(e.order,t.order):j(e.profile,t.profile)})),E=t.filter((function(e){return!e.order&&e.latitude&&e.longitude})),T=E.filter((function(e){return e.code.includes("guy")})),A=C.map((function(e){return e.profile})).sort((function(e,t){return j(e,t)})).filter((function(e,t,n){return n.indexOf(e)===t})),h(Object(d.a)(Object(d.a)({},b),{},{sortedStructures:C,sortedProfileNoList:A,otherPoints:E,guyPoints:T})),F=y({luminosity:"bright",count:A.length,hue:"red"}),z={},A.forEach((function(e,t){z[e]=F[t]})),console.log("Colors: ",z),console.log("Structure Data: ","data length: ",C.length,"sample: ",C[0]),console.log("Other Data: ","data length: ",E.length,"sample: ",E[0]),G=function(e){var t=[];return L.forEach(e,(function(e,n){var i={};i.objectID=n,i.id=e.id,e.order&&(i.mark=e.mark,i.profile=e.profile,i.order=e.order,i.structureAngles=e.structureAngles,i.structureGuys=e.structureGuys,i.measure=e.measure),i.longitude=e.longitude,i.latitude=e.latitude,i.code=e.code,i.attributes=e.attributes;var o=new p(e.longitude,e.latitude),r=new v({geometry:o,attributes:i});t.push(r)})),t},B=function(e){return function(t){return t.reduce((function(t,n){var i=n[e];return t[i]=(t[i]||[]).concat(n),t}),{})}}("profile"),V=B(C),A.map((function(e){var t={pointsSorted:V[e].sort((function(e,t){return j(e.order,t.order)})),pointsCount:V[e].length},n=Math.round(t.pointsSorted[t.pointsCount-1].measure,0);t=Object(d.a)({profileLength:n},t),M[e]=t})),R=function(){var e,t,n=[];A.map((function(i,o){t=M[i].pointsSorted,e=[],t.map((function(t){return e.push([t.longitude,t.latitude])}));var r=new g({hasZ:!1,hasM:!0,paths:e,spatialReference:{wkid:4326}}),a={};a.objectID=o,a.profileNo=i,a.count=t.length,a.length=t[t.length-1].measure;var c=new v({geometry:r,attributes:a});n.push(c)}));var i={type:"unique-value",field:"profileNo",uniqueValueInfos:Object.keys(M).map((function(e){return t=e,z[e],{value:t,label:t,symbol:{type:"cim",data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,width:3,color:[240,94,35,255]},{type:"CIMVectorMarker",enable:!0,size:10,markerPlacement:{type:"CIMMarkerPlacementAlongLineSameSize",endings:"WithMarkers",placementTemplate:[30],angleToLine:!0},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-8,-5.47],[-8,5.6],[1.96,-.03],[-8,-5.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[0,255,0,255]}]}}]}]}}}};var t}))};return[n,i]},q=function(){var e=R(),t=Object(m.a)(e,2),n=t[0],i=t[1];return new l({source:n,objectIdField:"objectID",fields:[{name:"objectID",type:"oid"},{name:"profileNo",type:"string"},{name:"count",type:"integer"},{name:"length",type:"double"}],popupTemplate:{title:"Profile",content:"Profile {profileNo} - {count} structures - {length} m"},renderer:i,title:"Profiles"})},W=function(){var e=G(C);return new l({source:e,objectIdField:"objectID",fields:[{name:"objectID",type:"oid"},{name:"id",type:"string"},{name:"profile",type:"string"},{name:"order",type:"string"},{name:"structureAngles",type:"string"},{name:"structureGuys",type:"string"},{name:"latitude",type:"double"},{name:"longitude",type:"double"},{name:"measure",type:"double"},{name:"code",type:"string"},{name:"mark",type:"string"},{name:"attributes",type:"string"}],popupTemplate:{title:"Structure Point",expressionInfos:[{name:"measure-roundup",title:"Measure Roundup",expression:"Round($feature.measure, 2)"}],content:"<div><h3>Point {mark}{order} - Profile{profile} - {id} - {code}</h3><ul><li>Measure: {expression/measure-roundup} m</li><li>Angles: {structureAngles}</li><li>Guys: {structureGuys}</li><li>Attributes: {attributes}</li></ul></div>"},renderer:{type:"unique-value",field:"profile",uniqueValueInfos:A.map((function(e){return{value:t=e,symbol:{type:"simple-marker",size:8,color:z[t],outline:{width:1.5,color:"white"}},label:t};var t}))},labelingInfo:H,title:"Structure Points"})},$=function(){var e=G(E);return console.log("other points number",e.length),new l({source:e,objectIdField:"objectID",fields:[{name:"objectID",type:"oid"},{name:"id",type:"string"},{name:"latitude",type:"double"},{name:"longitude",type:"double"},{name:"code",type:"string"},{name:"attributes",type:"string"}],popupTemplate:{title:"Non-Structure Point",content:"<p>Point <b>{id} ({code})</b></p><ul><li>{attributes}</li><ul>"},renderer:{type:"simple",symbol:{type:"simple-marker",size:5,color:"blue",outline:{width:.5,color:"white"}}},labelingInfo:_,title:"Non-Structure Points",visible:!0})},H={symbol:{type:"text",color:"red",haloColor:"white",haloSize:"1.5px",font:{size:"18px",family:"Noto Sans",style:"italic",weight:"bolder"}},labelPlacement:"above-right",labelExpressionInfo:{expression:"'P' + $feature.profile + '-' + $feature.mark[0] + '' + $feature.order"},deconflictionStrategy:"static"},_={symbol:{type:"text",color:"blue",haloColor:"white",haloSize:"1px",font:{size:"15px",family:"Noto Sans",style:"italic",weight:"bolder"}},labelPlacement:"above-right",labelExpressionInfo:{expression:"$feature.id + ' - ' + $feature.code"},deconflictionStrategy:"static"},Z=function(e){return e.queryExtent().then((function(e){k.goTo(e.extent).catch((function(e){"AbortError"!==e.name&&console.error(e)}))}))},J=W(),Q=$(),N=q(),new O({view:k,layer:J,container:"tableDiv",fieldConfigs:[{name:"objectID",label:"ID",visible:!1},{name:"id",label:"Point ID"},{name:"profile",label:"Profile",direction:"asc"},{name:"mark",label:"Structure Mark"},{name:"measure",label:"Measure (m)"},{name:"structureAngles",label:"Angles"},{name:"structureGuys",label:"Guys"}]}),N.when((function(){console.log("Zoom to line layer"),Z(N)})),P=new a({basemap:"hybrid",layers:[N,Q,J]}),k=new c({container:"viewDiv",center:[-168,46],zoom:2,map:P,highlightOptions:{color:[255,255,0,1],haloOpacity:.9,fillOpacity:.4},constraints:{rotationEnabled:!1}}),K=new x({view:k,listItemCreatedFunction:function(e){var t=e.item;t.title.includes("Profile")?(t.actionsOpen=!1,t.actionsSections=[["All"].concat(Object(u.a)(A)).map((function(e){var t;return t="All"===e?Object.keys(M).map((function(e){return M[e].profileLength})).reduce((function(e,t){return e+t})):M[e].profileLength,{title:"Profile ".concat(e," - ").concat(t," m"),className:"esri-icon-zoom-out-fixed",id:e}}))]):"Structure Points"===t.title&&(t.actionsOpen=!1,t.actionsSections=[C.map((function(e){return{title:"P".concat(e.profile,"-").concat(e.mark[0]).concat(e.order,"-").concat(e.id,"\n                                    ").concat(e.structureAngles.includes("running")?"-Running":"","\n                                    ").concat(e.structureAngles.includes("tap")?"-Tap":"","\n                                    ").concat(e.structureGuys&&e.structureGuys.includes("guy")?"-Guys":""),className:"esri-icon-zoom-out-fixed",id:"".concat(e.id)}}))])},container:"layerListDiv"}),k.ui.add(K,"top-right"),U=new S(["All"].concat(Object(u.a)(Object.keys(M))).map((function(e){return{id:e,expression:"profileNo = '".concat(e,"'")}}))),X=new S(C.map((function(e){return{id:e.id,expression:"id = '".concat(e.id,"'")}}))),Y=N.createQuery(),ee=J.createQuery(),k.whenLayerView(N).then((function(e){var t=N.fullExtent;ce.goToOverride=function(){k.goTo({target:t},{duration:2e3,easing:"in-out-expo"}).catch((function(e){"AbortError"!==e.name&&console.log(e)}))},K.on("trigger-action",(function(e){var n,i,o=e.action.id,r=e.item.layer;e.item.title.includes("Profile")?(n=U.find((function(e){return e.id===o})).expression,i=Y):(n=X.find((function(e){return e.id===o})).expression,i=ee),console.log("Expression: ",n),n.includes("All")?k.goTo({target:t},{duration:2e3,easing:"in-out-expo"}).catch((function(e){"AbortError"!==e.name&&console.log(e)})):(i.where=n,r.queryFeatures(i).then((function(e){var t=e.features[0];if(console.log("type",t.geometry.type),"point"===t.geometry.type)k.goTo({target:t.geometry,zoom:20},{duration:2e3,easing:"in-out-expo"}).catch((function(e){"AbortError"!==e.name&&console.log(e)}));else{var n=t.geometry.extent.clone();k.goTo({target:t.geometry,extent:n.expand(1.5)},{duration:2e3,easing:"in-out-expo"}).catch((function(e){"AbortError"!==e.name&&console.log(e)}))}})))}))})),r({viewDiv:{width:"100wh",height:"70vh"},tableDiv:{width:"100wh",height:"20vh",overflow:"auto"}})):(P=new a({basemap:"hybrid"}),k=new c({container:"viewDiv",center:[-116,54],zoom:6,map:P,highlightOptions:{color:[255,255,0,1],haloOpacity:.9,fillOpacity:.4}})),(te=document.createElement("div")).id="coordsWidget",te.className="esri-widget esri-component",te.style.padding="7px 15px 5px",ne=function(e){var t="Lat/Lon "+e.latitude.toFixed(3)+" "+e.longitude.toFixed(3)+" | Scale 1:"+Math.round(1*k.scale)/1+" | Zoom "+k.zoom;te.innerHTML=t},k.watch("stationary",(function(e){ne(k.center)})),k.on("pointer-move",(function(e){ne(k.toMap({x:e.x,y:e.y}))})),ie=new w,oe=document.getElementById("distance"),re=document.getElementById("area"),ae=document.getElementById("clear"),oe.addEventListener("click",(function(){se()})),re.addEventListener("click",(function(){ue()})),ae.addEventListener("click",(function(){de()})),ce=new D({view:k}),k.ui.add(ce,"top-left"),le=new I({view:k,nextBasemap:"topo-vector"}),k.ui.add(le,{position:"bottom-left"}),k.ui.add(te,"bottom-left"),k.ui.add(oe,"top-left"),k.ui.add(re,"top-left"),k.ui.add(ae,"top-left"),k.ui.add(ie,"top-left"),ie.view=k,e.next=53;break;case 50:e.prev=50,e.t0=e.catch(0),console.error(e.t0);case 53:case"end":return e.stop()}}),e,null,[[0,50]])})));return function(t){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){console.log("Map get data: ".concat((new Date).toLocaleTimeString()),x);var e=document.getElementById("layerListDiv"),t=document.getElementById("tableDiv");e&&(e.innerHTML="",t.innerHTML=""),w(x)}),[x]),Object(i.jsxs)("div",{id:"contentDiv",className:a.contentDiv,children:[Object(i.jsx)("div",{id:"viewDiv",style:n.viewDiv}),x&&Object(i.jsx)("div",{id:"tableDiv",style:n.tableDiv}),x&&Object(i.jsx)("div",{id:"layerListDiv",className:a.layerListDiv}),Object(i.jsxs)("div",{id:"toolbarDiv",class:"esri-component esri-widget",children:[Object(i.jsx)("button",{id:"distance",class:"esri-widget--button esri-interactive esri-icon-measure-line",title:"Distance Measurement Tool"}),Object(i.jsx)("button",{id:"area",class:"esri-widget--button esri-interactive esri-icon-measure-area",title:"Area Measurement Tool"}),Object(i.jsx)("button",{id:"clear",class:"esri-widget--button esri-interactive esri-icon-trash",title:"Clear Measurements"})]})]})},w=n(50),O=function(){var e=Object(o.useContext)(g),t=Object(m.a)(e,2),n=(t[0],t[1]);return Object(i.jsx)(w.a,{onDrop:function(e,t){console.log("values: ",Object.values(e));var i=Object.values(e).filter((function(e){return!!e})).map((function(e){var t=e.data;return e.data.order?{id:t.id,code:t.code,mark:t.struc_mark,profile:t.profile,order:t.order,structureAngles:t.struc_angles,structureGuys:t.struc_guys,longitude:parseFloat(t.longitude),latitude:parseFloat(t.latitude),measure:parseFloat(t.measure),attributes:t.attributes}:{id:t.id,code:t.code,longitude:parseFloat(t.longitude),latitude:parseFloat(t.latitude),attributes:t.attributes}}));n(Object(d.a)(Object(d.a)({},e),{},{csvValues:i,fileInfo:{name:t.name,lastModified:t.lastModifiedDate.toString()}}))},onError:function(e,t,n,i){console.log(e)},addRemoveButton:!0,removeButtonColor:"#659cef",onRemoveFile:function(e){},config:{header:!0},children:Object(i.jsx)("span",{children:"Drop CSV file here or click to upload."})})},S=(n(54),n(6)),D=(n(112),n(115),n(116));n(110),n(113),n(114),n(111),Object(b.a)({table:{},body:{},header:{}}),Object(S.a)({root:{color:"black",background:"whitesmoke",fontSize:16}})(D.a),Object(S.a)({root:{color:"white",background:"slateblue",fontSize:18}})(D.a);var I=Object(b.a)((function(e){return{panel:{width:"15%",margin:"15px 15px",color:"white",background:"slateblue",wordWrap:"break-word",borderRadius:"10px"},header:{fontSize:"30px",fontWeight:500,color:"wheat"},section:{margin:"5px",padding:"2px"},label:{fontSize:"20px",fontWeight:500,fontStyle:"italic"},details:{fontSize:"15px",fontWeight:300}}})),L=function(){var e=I(),t=Object(o.useContext)(g),n=Object(m.a)(t,1)[0];return Object(i.jsxs)("div",{className:e.panel,children:[n.fileInfo&&Object(i.jsxs)("div",{className:e.section,children:[Object(i.jsx)("p",{className:e.header,children:"File Info"}),Object(i.jsx)("p",{className:e.label,children:n.fileInfo.name}),Object(i.jsx)("p",{className:e.label,children:n.fileInfo.lastModified})]}),n.sortedProfileNoList&&Object(i.jsxs)("div",{className:e.section,children:[Object(i.jsx)("p",{className:e.header,children:"Project Details"}),Object(i.jsxs)("p",{className:e.label,children:[n.sortedProfileNoList.length," Profiles"]}),Object(i.jsx)("p",{className:e.details,children:n.sortedProfileNoList.join(", ")})]}),n.sortedStructures&&Object(i.jsx)("p",{className:e.section,children:Object(i.jsxs)("p",{className:e.label,children:[n.sortedStructures.length," Structures"]})}),n.otherPoints&&Object(i.jsx)("p",{className:e.section,children:Object(i.jsxs)("p",{className:e.label,children:[n.otherPoints.length," Non-Structures"]})})]})},P=function(){return Object(o.useEffect)((function(){document.title="Fortis CSV Viewer"}),[]),Object(i.jsx)(h,{children:Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(i.jsx)(L,{}),Object(i.jsxs)("div",{style:{width:"85%",height:"100%",margin:"5px 10px"},children:[Object(i.jsx)(O,{}),Object(i.jsx)(x,{})]})]})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,118)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),i(e),o(e),r(e),a(e)}))};c.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(P,{})}),document.getElementById("root")),k()}},[[88,1,2]]]);
//# sourceMappingURL=main.b7f7ebc2.chunk.js.map