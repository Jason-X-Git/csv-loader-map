(this["webpackJsonpcsv-loader-map"]=this["webpackJsonpcsv-loader-map"]||[]).push([[0],{38:function(e,t,n){},46:function(e,t){},48:function(e,t){},58:function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(0),i=n.n(r),a=n(27),c=n.n(a),l=(n(38),n(18)),u=n.n(l),s=n(19),d=n(32),p=n(28),f=n(3),m=n(29),b=n(69),h=Object(r.createContext)(),g=function(e){var t=Object(r.useState)([]),n=Object(f.a)(t,2),i=n[0],a=n[1];return Object(o.jsx)(h.Provider,{value:[i,a],children:e.children})},y=n(40),v=Object(b.a)((function(e){return{viewDiv:{width:"100wh",height:"90vh"},contentDiv:{width:"100wh",height:"90vh",margin:"10px 5px"},layerListDiv:{width:"200px",fontSize:"6px",padding:0}}})),j=function(){var e=v(),t=Object(r.useContext)(h),n=Object(f.a)(t,1)[0],i=function(){var e=Object(p.a)(u.a.mark((function e(t){var n,o,r,i,a,c,l,p,b,h,g,v,j,x,w,O,D,I,S,k,L,F,P,C,E,M,T,z,N,A,q,R,B,V,$,H,J,Z;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.filter((function(e){return!!e.order&&e.latitude&&e.longitude})),o=t.filter((function(e){return!e.order&&e.latitude&&e.longitude})),r=n.map((function(e){return e.profile})).filter((function(e,t,n){return n.indexOf(e)===t})),i=y({luminosity:"bright",count:r.length,hue:"red"}),a={},r.forEach((function(e,t){a[e]=i[t]})),console.log("Colors: ",a),console.log("Structure Data: ","data length: ",n.length,"sample: ",n[0]),console.log("Other Data: ","data length: ",o.length,"sample: ",o[0]),c={url:"https://js.arcgis.com/4.18/init.js",css:"https://js.arcgis.com/4.18/esri/themes/light/main.css"},e.next=13,Object(m.loadModules)(["esri/Map","esri/views/MapView","esri/layers/FeatureLayer","esri/geometry/Point","esri/geometry/Polyline","esri/Graphic","esri/widgets/LayerList","esri/core/Collection","dojo/_base/array","dojo/domReady!"],c);case 13:l=e.sent,p=Object(f.a)(l,9),b=p[0],h=p[1],g=p[2],v=p[3],j=p[4],x=p[5],w=p[6],O=p[7],D=p[8],I=function(e){var t=[];return D.forEach(e,(function(e){var n={};n.id=e.id,e.order&&(n.mark=e.mark,n.profile=e.profile,n.order=e.order,n.measure=e.measure),n.longitude=e.longitude,n.latitude=e.latitude,n.code=e.code,n.attributes=e.attributes;var o=new v(e.longitude,e.latitude),r=new x({geometry:o,attributes:n});t.push(r)})),t},S=function(e){return function(t){return t.reduce((function(t,n){var o=n[e];return t[o]=(t[o]||[]).concat(n),t}),{})}}("profile"),k=S(n),L={},Object.keys(k).map((function(e){var t={pointsSorted:k[e].sort((function(e,t){return parseInt(e.order)<parseInt(t.order)?-1:1})),pointsCount:k[e].length},n=Math.round(t.pointsSorted[t.pointsCount-1].measure,0);t=Object(d.a)({profileLength:n},t),L[e]=t})),F=function(){var e,t,n=[];Object.keys(L).map((function(o){t=L[o].pointsSorted,e=[],t.map((function(t){return e.push([t.longitude,t.latitude])}));var r=new j({hasZ:!1,hasM:!0,paths:e,spatialReference:{wkid:4326}}),i={};i.objectID=o,i.count=t.length,i.length=t[t.length-1].measure;var a=new x({geometry:r,attributes:i});n.push(a)}));var o={type:"unique-value",field:"objectID",uniqueValueInfos:Object.keys(L).map((function(e){return t=e,n=a[e],{value:t,symbol:{type:"simple-line",color:n,width:5},label:t};var t,n}))};return[n,o]},P=function(){var e=F(),t=Object(f.a)(e,2),n=t[0],o=t[1];return new g({source:n,objectIdField:"objectID",fields:[{name:"objectID",type:"oid"},{name:"count",type:"integer"},{name:"length",type:"double"}],popupTemplate:{title:"Profile",content:"Profile {objectID} - {count} structures - {length} m"},renderer:o,title:"Profiles"})},C=function(){var e=I(n);return new g({source:e,objectIdField:"id",fields:[{name:"id",type:"oid"},{name:"profile",type:"string"},{name:"order",type:"string"},{name:"latitude",type:"double"},{name:"longitude",type:"double"},{name:"measure",type:"double"},{name:"code",type:"string"},{name:"mark",type:"string"},{name:"attributes",type:"string"}],popupTemplate:{title:"Structure Point",expressionInfos:[{name:"measure-roundup",title:"Measure Roundup",expression:"Round($feature.measure, 0)"}],content:"<p>Point <b>{id} ({code})</b><ul><li>Order: {order}</li><li>Measure: {expression/measure-roundup} m</li><li>Attributes: {attributes}</li></ul>"},renderer:{type:"unique-value",field:"profile",uniqueValueInfos:r.map((function(e){return{value:t=e,symbol:{type:"simple-marker",size:8,color:a[t],outline:{width:1.5,color:"white"}},label:t};var t}))},labelingInfo:M,title:"Structure Points"})},E=function(){var e=I(o);return console.log("other points number",e.length),new g({source:e,objectIdField:"id",fields:[{name:"id",type:"oid"},{name:"latitude",type:"double"},{name:"longitude",type:"double"},{name:"code",type:"string"},{name:"attributes",type:"string"}],popupTemplate:{title:"Non-Structure Point",content:"<p>Point <b>{id} ({code})</b></p><ul><li>{attributes}</li><ul>"},renderer:{type:"simple",symbol:{type:"simple-marker",size:5,color:"blue",outline:{width:.5,color:"white"}}},labelingInfo:T,title:"Non-Structure Points"})},M={symbol:{type:"text",color:"red",haloColor:"white",haloSize:"1.5px",font:{size:"18px",family:"Noto Sans",style:"italic",weight:"bolder"}},labelPlacement:"above-right",labelExpressionInfo:{expression:"$feature.mark + '' + $feature.order"},deconflictionStrategy:"static"},T={symbol:{type:"text",color:"blue",haloColor:"white",haloSize:"1px",font:{size:"15px",family:"Noto Sans",style:"italic",weight:"bolder"}},labelPlacement:"above-right",labelExpressionInfo:{expression:"$feature.id + ' - ' + $feature.code"},deconflictionStrategy:"static"},z=function(e){return e.queryExtent().then((function(e){B.goTo(e.extent).catch((function(e){"AbortError"!==e.name&&console.error(e)}))}))},N=C(),A=E(),(q=P()).when((function(){z(q)})),R=new b({basemap:"hybrid",layers:[q,A,N]}),B=new h({container:"viewDiv",center:[-168,46],zoom:2,map:R,highlightOptions:{color:[255,255,0,1],haloOpacity:.9,fillOpacity:.4}}),V=new w({view:B,listItemCreatedFunction:function(e){var t=e.item;t.title.includes("Profile")&&(t.actionsOpen=!1,t.actionsSections=[["All"].concat(Object(s.a)(Object.keys(L))).map((function(e){var t;return t="All"===e?Object.keys(L).map((function(e){return L[e].profileLength})).reduce((function(e,t){return e+t})):L[e].profileLength,{title:"Profile ".concat(e," - ").concat(t," m"),className:"esri-icon-zoom-out-fixed",id:e}}))])},container:"layerListDiv"}),B.ui.add(V,"top-right"),$=new O(["All"].concat(Object(s.a)(Object.keys(L))).map((function(e){return{id:e,expression:"objectID = '".concat(e,"'")}}))),H=q.createQuery(),B.whenLayerView(q).then((function(e){var t=q.fullExtent;V.on("trigger-action",(function(e){var n=e.action.id,o=e.item.layer,r=$.find((function(e){return e.id===n})).expression;r.includes("All")?B.goTo({target:t},{duration:2e3,easing:"in-out-expo"}).catch((function(e){"AbortError"!==e.name&&console.log(e)})):(H.where=r,o.queryFeatures(H).then((function(e){var t=e.features[0],n=t.geometry.extent.clone();B.goTo({target:t.geometry,extent:n.expand(1.5)},{duration:2e3,easing:"in-out-expo"}).catch((function(e){"AbortError"!==e.name&&console.log(e)}))})))}))})),(J=document.createElement("div")).id="coordsWidget",J.className="esri-widget esri-component",J.style.padding="7px 15px 5px",B.ui.add(J,"bottom-left"),Z=function(e){var t="Lat/Lon "+e.latitude.toFixed(3)+" "+e.longitude.toFixed(3)+" | Scale 1:"+Math.round(1*B.scale)/1+" | Zoom "+B.zoom;J.innerHTML=t},B.watch("stationary",(function(e){Z(B.center)})),B.on("pointer-move",(function(e){Z(B.toMap({x:e.x,y:e.y}))})),e.next=62;break;case 59:e.prev=59,e.t0=e.catch(0),console.error(e.t0);case 62:case"end":return e.stop()}}),e,null,[[0,59]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){if(console.log("Map get data: ".concat((new Date).toLocaleTimeString()),n),n&&n.length>0){var e=document.getElementById("layerListDiv");e&&(e.innerHTML=""),i(n)}}),[n]),Object(o.jsxs)("div",{id:"contentDiv",className:e.contentDiv,children:[Object(o.jsx)("div",{id:"viewDiv",className:e.viewDiv}),n&&Object(o.jsx)("div",{id:"layerListDiv",className:e.layerListDiv})]})},x=n(30),w=function(){var e=Object(r.useContext)(h),t=Object(f.a)(e,2)[1];return Object(o.jsx)(x.a,{onDrop:function(e){var n=Object.values(e).filter((function(e){return!!e})).map((function(e){var t=e.data;return e.data.order?{id:t.id,code:t.code,mark:t.struc_mark,profile:t.profile,order:t.order,longitude:parseFloat(t.longitude),latitude:parseFloat(t.latitude),measure:parseFloat(t.measure),attributes:t.attributes}:{id:t.id,code:t.code,longitude:parseFloat(t.longitude),latitude:parseFloat(t.latitude),attributes:t.attributes}}));t(n)},onError:function(e,t,n,o){console.log(e)},addRemoveButton:!0,removeButtonColor:"#659cef",onRemoveFile:function(e){},config:{header:!0},children:Object(o.jsx)("span",{children:"Drop CSV file here or click to upload."})})},O=function(){return Object(o.jsx)("div",{style:{width:"95%",height:"100%",margin:"auto"},children:Object(o.jsxs)(g,{children:[Object(o.jsx)(w,{}),Object(o.jsx)(j,{})]})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,70)).then((function(t){var n=t.getCLS,o=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),o(e),r(e),i(e),a(e)}))};c.a.render(Object(o.jsx)(i.a.StrictMode,{children:Object(o.jsx)(O,{})}),document.getElementById("root")),D()}},[[58,1,2]]]);
//# sourceMappingURL=main.2bf1c1fc.chunk.js.map